# Sample Surge Configuration

# Line started with "#" or "//" shall be comments.
# ä»¥ "#" æˆ– "//" å¼€å¤´çš„è¡Œä¸ºæ³¨é‡Šè¡Œ
[General]
# --- GENERAL ---
# Wi-Fi Assist
wifi-assist = false

# Latency Benchmark
internet-test-url = http://bing.com
proxy-test-url = http://www.gstatic.com/generate_204
test-timeout = 5

# TLS Engine
tls-provider = openssl

# GeoIP Database
geoip-maxmind-url = https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
ipv6 = true

# Wi-Fi Access
allow-wifi-access = false
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153

http-listen = 127.0.0.1:6152
socks5-listen = 127.0.0.1:6153

# Remote Controller
external-controller-access = passw0rd@127.0.0.1:6170

# HTTP API
http-api = passw0rd@0.0.0.0:6166

# Compatibility
# > å…¼å®¹æ¨¡å¼
compatibility-mode = False
# > è·³è¿‡ä»£ç†
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, passenger.t3go.cn, localhost, *.local
# > æŽ’é™¤ç®€å•ä¸»æœºå
exclude-simple-hostnames = true

# Experimental
network-framework = false

# DNS Server
dns-server = 223.5.5.5, 114.114.114.114, system
# > ä»Ž /etc/hosts è¯»å– DNS è®°å½•
read-etc-hosts = true
//doh-server = https://doh.pub/dns-query //DNSPod
# > DOH è¯·æ±‚é€šè¿‡ä»£ç†ç­–ç•¥æ‰§è¡Œ
doh-follow-outbound-mode = false

# --- ADVANCED ---
# Log Level
loglevel = notify
# å½“é‡åˆ° REJECT ç­–ç•¥æ—¶è¿”å›žé”™è¯¯é¡µ
show-error-page-for-reject = true
# Always Real IP Hosts
always-real-ip = link-ip.nextdns.io, msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net
# Hijack DNS
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
# TCP Force HTTP Hosts
force-http-engine-hosts = *.ott.cibntv.net,123.59.31.1,119.18.193.135,122.14.246.33,175.102.178.52
# VIF Excluded Routes
tun-excluded-routes = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 239.255.255.250/32
# VIF Included Routes
tun-included-routes = 192.168.1.12/32
# å½“ Wi-Fi ä¸æ˜¯é¦–é€‰ç½‘ç»œæ—¶ SSID ç»„ç­–ç•¥ä½¿ç”¨é»˜è®¤ç­–ç•¥
use-default-policy-if-wifi-not-primary = false

[Replica]
# æŠ“å–æµé‡ => è¿‡æ»¤å™¨ 1ä¸ºå¼€å¯ï¼Œ0ä¸ºå…³é—­
# > éšè— Apple è¯·æ±‚
hide-apple-request = 1
# > éšè— Crashlytics è¯·æ±‚
hide-crash-reporter-request = 1
# > éšè— UDP ä¼šè¯
hide-udp = 1
# > å…³é”®è¯è¿‡æ»¤å™¨
//noneï¼ˆå…³é—­å…³é”®è¯è¿‡æ»¤å™¨ï¼‰ / whitelistï¼ˆä»…è®°å½•åŒ…å«å…³é”®è¯çš„è¯·æ±‚ï¼‰ / blacklistï¼ˆä»…è®°å½•ä¸åŒ…å«å…³é”®è¯çš„è¯·æ±‚ï¼‰ / patternï¼ˆè®°å½•åŒ¹é…é€šé…ç¬¦çš„è¯·æ±‚ï¼‰
keyword-filter-type = blacklist
keyword-filter = icloud, ocsp, logs, analytic, imap, adthor, applovin, appnext, talk, dropbox, github, spys, nexdns, 149.154, 91.108

[Proxy]
# å½“è¯·æ±‚ä¸º HTTP è¯·æ±‚æ—¶è¿”å›žä¸€ä¸ªæžå°çš„ GIF
REJECT-TINYGIF = reject-tinygif
# é˜»æ­¢è¯·æ±‚
REJECT = reject
# ç›´æŽ¥è¿žæŽ¥
DIRECT = direct

[Proxy Group]
# ç™½åå•æ¨¡å¼ PROXYï¼Œé»‘åå•æ¨¡å¼ DIRECT
Final = select, ProxyðŸª, DIRECT
# å…·ä½“å“ªä¸ªå­ç­–ç•¥å°†è¢«ä½¿ç”¨, æ ¹æ® Wi-FI çš„ SSID å†³å®š
# Home â›ºï¸ = ssid, default = ProxyðŸª, cellular = ProxyðŸª, "ssid1" = ProxyðŸª, "ssid2" = DIRECT
ProxyðŸª = select, ðŸ‡ºðŸ‡¸ America, ðŸ‡­ðŸ‡° Load balance, ðŸ‡¸ðŸ‡¬ Singapore, ðŸ‡¨ðŸ‡³ Fallback, policy-path=https://sub.store/download/STT
GlobalMedia = select, ðŸ‡ºðŸ‡¸ America, ðŸ‡­ðŸ‡° Load balance, ðŸ‡¸ðŸ‡¬ Singapore, ðŸ‡¨ðŸ‡³ Fallback
Netflix = select, ðŸ‡ºðŸ‡¸ America, ðŸ‡­ðŸ‡° Load balance, ðŸ‡¸ðŸ‡¬ Singapore, ðŸ‡¨ðŸ‡³ Fallback
Twitter = select, ðŸ‡ºðŸ‡¸ America, ProxyðŸª 
Telegram = select, ðŸ‡­ðŸ‡° Hong Kong, ðŸ‡¸ðŸ‡¬ Singapore
Apple = select, DIRECT, ProxyðŸª
AdBlock = select, REJECT, DIRECT, REJECT-TINYGIF
ðŸ‡ºðŸ‡¸ America = url-test, policy-path=https://sub.store/download/STT, policy-regex-filter=ç¾Žå›½, interval=600, tolerance=100, evaluate-before-use=true, hidden=true
ðŸ‡­ðŸ‡° Load balance = load-balance, policy-path=https://sub.store/download/STT, policy-regex-filter=(é¦™æ¸¯|HK), interval=-1, tolerance=100, persistent=true, hidden=true
ðŸ‡¸ðŸ‡¬ Singapore = load-balance, policy-path=https://sub.store/download/STT, policy-regex-filter=(æ–°åŠ å¡|ç‹®åŸŽ), interval=-1, tolerance=100, persistent=true, hidden=true
ðŸ‡¨ðŸ‡³ Fallback = fallback, policy-path=https://sub.store/download/STT, policy-regex-filter=å°æ¹¾, timeout=3, interval=600, evaluate-before-use=true, hidden=true

[Rule]
# Client For macOS
# > Proxy
PROCESS-NAME,v2ray,DIRECT
PROCESS-NAME,ss-local,DIRECT
PROCESS-NAME,UUBooster,DIRECT
# > Download
PROCESS-NAME,aria2c,DIRECT
PROCESS-NAME,fdm,DIRECT
PROCESS-NAME,Folx,DIRECT
PROCESS-NAME,NetTransport,DIRECT
PROCESS-NAME,Thunder,DIRECT
PROCESS-NAME,Transmission,DIRECT
PROCESS-NAME,uTorrent,DIRECT
PROCESS-NAME,WebTorrent,DIRECT
PROCESS-NAME,WebTorrent Helper,DIRECT

# CUSTOM RULES
# > External Resources Update
AND,((DOMAIN,raw.githubusercontent.com), (USER-AGENT,Surge/*)),Final,notification-text="â™»ï¸External Resources Update",notification-interval=3600

# RULE-SET
# > Unbreak
RULE-SET,https://blankmagic.github.io/surge/rule/Unbreak.list,DIRECT
# > Advertising
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list,AdBlock
# > Hijacking
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list,AdBlock
# > Netflix
RULE-SET,https://blankmagic.github.io/surge/rule/media/Netflix.list,Netflix
# > GlobalMedia
RULE-SET,https://blankmagic.github.io/surge/rule/GlobalMedia.list,GlobalMedia
# > Twitter
RULE-SET,https://blankmagic.github.io/surge/rule/Twitter.list,Twitter
# > Telegram
RULE-SET,https://blankmagic.github.io/surge/rule/Telegram.list,Telegram
# > Apple
RULE-SET,https://blankmagic.github.io/surge/rule/apple/Apple.list,Apple
# > Global
RULE-SET,https://blankmagic.github.io/surge/rule/Global.list,ProxyðŸª
# > Domestic
RULE-SET,https://blankmagic.github.io/surge/rule/Domestic.list,DIRECT

IP-CIDR,0.0.0.0/32,REJECT,no-resolve

# Local Area Network
RULE-SET,LAN,DIRECT

# GeoIP China
GEOIP,CN,DIRECT

FINAL,Final,dns-failed

[Host]
# Firebase Cloud Messaging
mtalk.google.com = 108.177.125.188
# Google Dl
dl.google.com = server:119.29.29.29
dl.l.google.com = server:119.29.29.29
# CUSTOM HOST

[URL Rewrite]
# Redirect Google Search Service
^(http|https):\/\/(www.)?(g|google)\.cn https://www.google.com 302

# Redirect Google Maps Service
^(http|https):\/\/(ditu|maps).google\.cn https://maps.google.com 302

# AbeamTV - api.abema.io
^(http|https):\/\/api\.abema\.io\/v\d\/ip\/check - reject
# CUSTOM URL

[Header Rewrite] 
^https?:\/\/.*\.baidu\.com header-replace User-Agent "Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Mobile/15E148 Safari/16C50 Quark/604.1 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)"

^https?:\/\/.*\.zhihu\.com\/(question|topic) header-replace User-Agent "osee2unifiedRelease/4432 osee2unifiedReleaseVersion/7.8.0 Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"

[SSID Setting]
# Temporarily Suspend
"CUSTOM SSID" suspend=true

[MITM]
skip-server-cert-verify = true
hostname = www.google.cn, api.abema.io, *.baidu.com, *.zhihu.com, -CUSTOMMitM

[Script]
Sub_info = type=http-request,pattern=http://sub\.info,script-path=https://blankmagic.github.io/surge/docs/js/sub_info.js
