[General]
# --- GENERAL ---
# Wi-Fi Assist
wifi-assist = false

# Latency Benchmark
internet-test-url = http://bing.com
proxy-test-url = http://www.gstatic.com/generate_204
test-timeout = 5

# TLS Engine
tls-provider = openssl

# GeoIP Database
geoip-maxmind-url = https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
ipv6 = true

# Wi-Fi Access
allow-wifi-access = false
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153

http-listen = 127.0.0.1:6152
socks5-listen = 127.0.0.1:6153

# Remote Controller
external-controller-access = apassword@127.0.0.1:8888

# HTTP API
http-api = apassword@0.0.0.0:6166

# Compatibility
# > å…¼å®¹æ¨¡å¼
compatibility-mode = False
# > è·³è¿‡ä»£ç†
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, passenger.t3go.cn, localhost, *.local
# > æ’é™¤ç®€å•ä¸»æœºå
exclude-simple-hostnames = true

# Experimental
network-framework = false

# DNS Server
dns-server = 223.5.5.5, 114.114.114.114, system
# > ä» /etc/hosts è¯»å– DNS è®°å½•
read-etc-hosts = true
//doh-server = https://doh.pub/dns-query //DNSPod
# > DoH è¯·æ±‚é€šè¿‡ä»£ç†ç­–ç•¥æ‰§è¡Œ
doh-follow-outbound-mode = false

# --- ADVANCED ---
# Log Level
loglevel = notify
# å½“é‡åˆ° REJECT ç­–ç•¥æ—¶è¿”å›é”™è¯¯é¡µ
show-error-page-for-reject = true
# Always Real IP Hosts
always-real-ip = link-ip.nextdns.io, msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net
# Hijack DNS
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
# TCP Force HTTP Hosts
force-http-engine-hosts = *.ott.cibntv.net,123.59.31.1,119.18.193.135,122.14.246.33,175.102.178.52
# VIF Excluded Routes
tun-excluded-routes = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 239.255.255.250/32
# VIF Included Routes
tun-included-routes = 192.168.1.12/32
# å½“ Wi-Fi ä¸æ˜¯é¦–é€‰ç½‘ç»œæ—¶ SSID ç»„ç­–ç•¥ä½¿ç”¨é»˜è®¤ç­–ç•¥
use-default-policy-if-wifi-not-primary = false

[Replica]
# æŠ“å–æµé‡ => è¿‡æ»¤å™¨ 1ä¸ºå¼€å¯ï¼Œ0ä¸ºå…³é—­
# > éšè— Apple è¯·æ±‚
hide-apple-request = 1
# > éšè— Crashlytics è¯·æ±‚
hide-crash-reporter-request = 1
# > éšè— UDP ä¼šè¯
hide-udp = 1
# > å…³é”®è¯è¿‡æ»¤å™¨
//noneï¼ˆå…³é—­å…³é”®è¯è¿‡æ»¤å™¨ï¼‰ / whitelistï¼ˆä»…è®°å½•åŒ…å«å…³é”®è¯çš„è¯·æ±‚ï¼‰ / blacklistï¼ˆä»…è®°å½•ä¸åŒ…å«å…³é”®è¯çš„è¯·æ±‚ï¼‰ / patternï¼ˆè®°å½•åŒ¹é…é€šé…ç¬¦çš„è¯·æ±‚ï¼‰
keyword-filter-type = blacklist
keyword-filter = icloud, ocsp, logs, analytic, imap, adthor, applovin, appnext, talk, dropbox, github, spys, nexdns, 149.154, 91.108

[Proxy]
# å½“è¯·æ±‚ä¸º HTTP è¯·æ±‚æ—¶è¿”å›ä¸€ä¸ªæå°çš„ GIF
REJECT-TINYGIF = reject-tinygif
# é˜»æ­¢è¯·æ±‚
REJECT = reject
# ç›´æ¥è¿æ¥
DIRECT = direct

# è¯¥æ®µå®šä¹‰å¯ç”¨çš„ç­–ç•¥ç»„
# ä¸€ä¸ªç­–ç•¥ç»„å¯ä»¥åŒ…æ‹¬å¤šä¸ªå­ç­–ç•¥. 
# å­ç­–ç•¥å¯ä»¥æ˜¯ä¸€ä¸ªä»£ç†ç­–ç•¥ï¼Œæˆ–è€…å¦ä¸€ä¸ªç­–ç•¥ç»„ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå†…ç½®ç­–ç•¥ (DIRECT æˆ– REJECT).
# æœ‰ 5 ç§ç­–ç•¥ç»„ç±»å‹: "select", "url-test", "fallback", "ssid" å’Œ "load-balance"
# select: å…·ä½“å“ªä¸ªå­ç­–ç•¥å°†è¢«ä½¿ç”¨ï¼Œç”±ç”¨æˆ·ç•Œé¢ä¸Šè¿›è¡Œé€‰æ‹©ã€‚
# url-test: å…·ä½“å“ªä¸ªå­ç­–ç•¥å°†è¢«ä½¿ç”¨ï¼Œé€šè¿‡æµ‹è¯•åˆ°å…·ä½“ URL çš„è®¿é—®é€Ÿåº¦é€‰æ‹©å»¶è¿Ÿæœ€ä½çš„ç­–ç•¥
#   å‚æ•°:
#   url: æµ‹è¯•æ—¶ç”¨åˆ°çš„ç›®æ ‡ URL.   
#   interval: å¯é€‰, ç§’ (é»˜è®¤å€¼: 600s)
#   æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´åï¼Œä¸Šæ¬¡çš„æµ‹è¯•ç»“æœå°†è¢«æŠ›å¼ƒã€‚
#   tolerance: å¯é€‰, æ¯«ç§’ (é»˜è®¤å€¼: 100ms)
#   åªæœ‰å½“æ–°çš„ä¼˜é€‰çº¿è·¯ï¼Œæ¯”åŸä¼˜é€‰çº¿è·¯çš„å“åº”æ—¶é—´ï¼Œå¤§äºè¯¥å€¼çš„æ—¶å€™ï¼Œæ‰ä¼šè§¦å‘çº¿è·¯å˜æ›´ã€‚
#   timeout: å¯é€‰, ç§’ (é»˜è®¤å€¼: 5s)
#   å¦‚æœæŸç­–ç•¥åœ¨è¯¥æ—¶é—´åä¾ç„¶æ²¡æœ‰å®Œæˆï¼Œæ”¾å¼ƒè¯¥ç­–ç•¥ã€‚
# fallback: ä¸ url-test ç»„åŸºæœ¬ä¸€è‡´ï¼ŒåŒºåˆ«æ˜¯åªå…³å¿ƒå­ç­–ç•¥æ˜¯å¦å¯ç”¨è€Œä¸å…³å¿ƒå…·ä½“å»¶è¿Ÿï¼Œç„¶å
#   ä»å¯ç”¨ç­–ç•¥ä¸­é€‰æ‹©é å‰çš„ç­–ç•¥ã€‚å¯ä»¥é€šè¿‡è°ƒå° timeout å‚æ•°å°†ç¼“æ…¢çº¿è·¯ä¹Ÿæ ‡è®°ä¸ºä¸å¯ç”¨ã€‚
#   è¯¥ç±»å‹æ²¡æœ‰ tolerance å‚æ•°ã€‚
# ssid: å…·ä½“å“ªä¸ªå­ç­–ç•¥å°†è¢«ä½¿ç”¨ï¼Œæ ¹æ® Wi-FI çš„ SSIDã€BSSIDã€è·¯ç”± IP åœ°å€å†³å®š
#   å‚æ•°:
#   default: å¿…å¡«
#   é»˜è®¤ç­–ç•¥ã€‚
#   cellular: å¯é€‰
#   åœ¨æ•°æ®ç½‘ç»œä¸‹çš„ç­–ç•¥ã€‚ è‹¥ä¸å¡«ï¼Œé‚£ä¹ˆé»˜è®¤ç­–ç•¥å°†è¢«ä½¿ç”¨ã€‚
# load-balance: éšæœºä»å­ç­–ç•¥ä¸­é€‰å–ä¸€ä¸ªç­–ç•¥ä½¿ç”¨ã€‚å½“é…ç½®äº† url å‚æ•°æ—¶ï¼Œä¼š
#   æŒ‰ç…§ fallback ç»„çš„è¡Œä¸ºè¿›è¡Œå¯ç”¨æ€§æ£€æŸ¥ï¼Œç„¶åä»…ä»å¯ç”¨çš„å­ç­–ç•¥ä¸­éšæœºé€‰å–ã€‚
#   å‚æ•°: 
#   é™¤ urlã€timeoutã€intervalå¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°ï¼š
#   persistentï¼šå½“ persistent=true æ—¶ï¼Œå¯¹äºåŒä¸€ç›®æ ‡ä¸»æœºåï¼Œå°†å°½é‡ä½¿ç”¨åŒä¸€ä¸ªç­–ç•¥ã€‚
#   é¿å…å› å‡ºå£ IP ä¸åŒè€Œè§¦å‘ç›®æ ‡ç½‘ç«™çš„é£é™©æ§åˆ¶ã€‚ä½†å½“å¯ç”¨æ€§æ”¹å˜æ—¶å¯èƒ½å¯¼è‡´ç­–ç•¥å˜åŒ–ã€‚

[Proxy Group]
Final = select, ProxyğŸª, DIRECT
# SSIDâ›ºï¸ = ssid, default = ProxyğŸª, cellular = ProxyğŸª, "SSID 1" = ProxyğŸª, "SSID 2" = DIRECT
ProxyğŸª = select, ğŸ‡ºğŸ‡¸ America, ğŸ‡­ğŸ‡° Load balance, ğŸ‡¸ğŸ‡¬ Singapore, ğŸ‡¨ğŸ‡³ Fallback, policy-path=https://sub.store/download/STT
GlobalMedia = select, ğŸ‡ºğŸ‡¸ America, ğŸ‡­ğŸ‡° Load balance, ğŸ‡¸ğŸ‡¬ Singapore, ğŸ‡¨ğŸ‡³ Fallback
Netflix = select, ğŸ‡ºğŸ‡¸ America, ğŸ‡­ğŸ‡° Load balance, ğŸ‡¸ğŸ‡¬ Singapore, ğŸ‡¨ğŸ‡³ Fallback
Twitter = select, ğŸ‡ºğŸ‡¸ America, ProxyğŸª 
Telegram = select, ğŸ‡­ğŸ‡° Load balance, ğŸ‡¸ğŸ‡¬ Singapore
Apple = select, DIRECT, ProxyğŸª
AdBlock = select, REJECT, DIRECT, REJECT-TINYGIF
ğŸ‡ºğŸ‡¸ America = url-test, policy-path=https://sub.store/download/STT, policy-regex-filter=ç¾å›½, interval=600, tolerance=100, evaluate-before-use=true, hidden=true
ğŸ‡­ğŸ‡° Load balance = load-balance, policy-path=https://sub.store/download/STT, policy-regex-filter=(é¦™æ¸¯|HK), interval=-1, tolerance=100, persistent=true, hidden=true
ğŸ‡¸ğŸ‡¬ Singapore = load-balance, policy-path=https://sub.store/download/STT, policy-regex-filter=(æ–°åŠ å¡|ç‹®åŸ), interval=-1, tolerance=100, persistent=true, hidden=true
ğŸ‡¨ğŸ‡³ Fallback = fallback, policy-path=https://sub.store/download/STT, policy-regex-filter=å°æ¹¾, timeout=3, interval=600, evaluate-before-use=true, hidden=true

# è¯¥æ®µå®šä¹‰è¯·æ±‚å¤„ç†è§„åˆ™
# ä¸€ä¸ªè§„åˆ™æœ‰ä¸‰ä¸ªåŸºç¡€éƒ¨åˆ†:
#          ç±»å‹,          å€¼,            ç­–ç•¥
# æ¯”å¦‚:    DOMAIN-SUFFIX,apple.com,     DIRECT
#          IP-CIDR,      192.168.0.0/16,Proxy
# è¯¦è§ï¼šhttps://manual.nssurge.com/book/understanding-surge/cn/

[Rule]
# Client For macOS
# > Proxy
PROCESS-NAME,v2ray,DIRECT
PROCESS-NAME,ss-local,DIRECT
PROCESS-NAME,UUBooster,DIRECT
# > Download
PROCESS-NAME,aria2c,DIRECT
PROCESS-NAME,fdm,DIRECT
PROCESS-NAME,Folx,DIRECT
PROCESS-NAME,NetTransport,DIRECT
PROCESS-NAME,Thunder,DIRECT
PROCESS-NAME,Transmission,DIRECT
PROCESS-NAME,uTorrent,DIRECT
PROCESS-NAME,WebTorrent,DIRECT
PROCESS-NAME,WebTorrent Helper,DIRECT

# CUSTOM RULES
# > External Resources Update
AND,((DOMAIN,raw.githubusercontent.com), (USER-AGENT,Surge/*)),Final,notification-text="â™»ï¸External Resources Update",notification-interval=3600

# RULE-SET
# > Unbreak
RULE-SET,https://blankmagic.github.io/surge/rule/Unbreak.list,DIRECT
# > Advertising
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list,AdBlock
# > Hijacking
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list,AdBlock
# > Netflix
RULE-SET,https://blankmagic.github.io/surge/rule/media/Netflix.list,Netflix
# > GlobalMedia
RULE-SET,https://blankmagic.github.io/surge/rule/GlobalMedia.list,GlobalMedia
# > Twitter
RULE-SET,https://blankmagic.github.io/surge/rule/Twitter.list,Twitter
# > Telegram
RULE-SET,https://blankmagic.github.io/surge/rule/Telegram.list,Telegram
# > Apple
RULE-SET,https://blankmagic.github.io/surge/rule/apple/Apple.list,Apple
# > Global
RULE-SET,https://blankmagic.github.io/surge/rule/Global.list,ProxyğŸª
# > Domestic
RULE-SET,https://blankmagic.github.io/surge/rule/Domestic.list,DIRECT

IP-CIDR,0.0.0.0/32,REJECT,no-resolve

# Local Area Network
RULE-SET,LAN,DIRECT

# GeoIP China
GEOIP,CN,DIRECT

FINAL,Final,dns-failed

# è¯¥æ®µå®šä¹‰æœ¬åœ° DNS è®°å½•
# è¯¥åŠŸèƒ½ç­‰åŒäº /etc/hostsï¼ŒåŠ ä¸Šäº†æ³›è§£æå’Œåˆ«åæ”¯æŒã€‚
[Host]
# Firebase Cloud Messaging
mtalk.google.com = 108.177.125.188
# Google Dl
dl.google.com = server:119.29.29.29
dl.l.google.com = server:119.29.29.29
# CUSTOM HOST

[URL Rewrite]
# Redirect Google Search Service
^(http|https):\/\/(www.)?(g|google)\.cn https://www.google.com 302

# Redirect Google Maps Service
^(http|https):\/\/(ditu|maps).google\.cn https://maps.google.com 302

# AbeamTV - api.abema.io
^(http|https):\/\/api\.abema\.io\/v\d\/ip\/check - reject
# CUSTOM URL

[Header Rewrite] 
^https?:\/\/.*\.baidu\.com header-replace User-Agent "Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Mobile/15E148 Safari/16C50 Quark/604.1 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)"

^https?:\/\/.*\.zhihu\.com\/(question|topic) header-replace User-Agent "osee2unifiedRelease/4432 osee2unifiedReleaseVersion/7.8.0 Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mo    bile/15E148"

# è¯¥æ®µä»…åœ¨ iOS ç‰ˆæœ¬ä¸‹ç”Ÿæ•ˆã€‚ 
# ä½ å¯ä»¥ä¸ºæŸäº›ç‰¹å®šçš„ WiFi ç½‘ç»œè®¾ç½®è®¾ç½®å‚æ•°
# å‚æ•°:
# suspend: "true" æˆ– "false"
# åœ¨è¯¥ç½‘ç»œä¸‹ Surge å°†æš‚åœå·¥ä½œã€‚ è¯·æ³¨æ„ï¼Œå¦‚æœä½ åœ¨è¯¥ç½‘ç»œä¸‹ç›´æ¥å¯åŠ¨ Surgeï¼Œé‚£ä¹ˆ 
# Surge ä¾ç„¶ä¼šå·¥ä½œã€‚åªæœ‰å½“ä»å…¶ä»–ç½‘ç»œåˆ‡æ¢åˆ°è¯¥ç½‘ç»œæ—¶ï¼ŒSurge æ‰ä¼šæš‚åœã€‚
[SSID Setting]
# Temporarily Suspend
"SSID Here" suspend=true

[MITM]
skip-server-cert-verify = true
hostname = www.google.cn, api.abema.io, *.baidu.com, *.zhihu.com, -CUSTOMMitM

[Script]
Sub_info = type=http-request,pattern=http://sub\.info,script-path=https://blankmagic.github.io/surge/docs/js/sub_info.js
