# Sample Surge Configuration

# Line started with "#" or "//" shall be comments.
# ä»¥ "#" æˆ– "//" å¼€å¤´çš„è¡Œä¸ºæ³¨é‡Šè¡Œ
[General]
# --- GENERAL ---
# Wi-Fi Assist
wifi-assist = false

# Latency Benchmark
internet-test-url = http://bing.com
proxy-test-url = http://www.gstatic.com/generate_204
test-timeout = 5

# TLS Engine
tls-provider = openssl

# GeoIP Database
geoip-maxmind-url = https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
ipv6 = true

# Wi-Fi Access
allow-wifi-access = false
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153

http-listen = 127.0.0.1:6152
socks5-listen = 127.0.0.1:6153

# Remote Controller
external-controller-access = passw0rd@127.0.0.1:6170

# HTTP API
http-api = passw0rd@0.0.0.0:6166

# Compatibility
# > å…¼å®¹æ¨¡å¼
compatibility-mode = False
# > è·³è¿‡ä»£ç†
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, passenger.t3go.cn, localhost, *.local
# > æ’é™¤ç®€å•ä¸»æœºå
exclude-simple-hostnames = true

# Experimental
network-framework = false

# DNS Server
dns-server = 223.5.5.5, 114.114.114.114
# > ä» /etc/hosts è¯»å– DNS è®°å½•
read-etc-hosts = true
//doh-server = https://dns.alidns.com/dns-query
# > DOH è¯·æ±‚é€šè¿‡ä»£ç†ç­–ç•¥æ‰§è¡Œ
doh-follow-outbound-mode = false

# --- ADVANCED ---
# Log Level
loglevel = notify
# å½“é‡åˆ° REJECT ç­–ç•¥æ—¶è¿”å›é”™è¯¯é¡µ
show-error-page-for-reject = true
# Always Real IP Hosts
always-real-ip = link-ip.nextdns.io, msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net
# Hijack DNS
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
# TCP Force HTTP Hosts
force-http-engine-hosts = *.ott.cibntv.net,123.59.31.1,119.18.193.135,122.14.246.33,175.102.178.52
# VIF Excluded Routes
tun-excluded-routes = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 239.255.255.250/32
# VIF Included Routes
tun-included-routes = 192.168.1.12/32
# å½“ Wi-Fi ä¸æ˜¯é¦–é€‰ç½‘ç»œæ—¶ SSID ç»„ç­–ç•¥ä½¿ç”¨é»˜è®¤ç­–ç•¥
use-default-policy-if-wifi-not-primary = false

[Replica]
# æŠ“å–æµé‡ => è¿‡æ»¤å™¨ 1ä¸ºå¼€å¯ï¼Œ0ä¸ºå…³é—­
# > éšè— Apple è¯·æ±‚
hide-apple-request = 1
# > éšè— Crashlytics è¯·æ±‚
hide-crash-reporter-request = 1
# > éšè— UDP ä¼šè¯
hide-udp = 1
# > å…³é”®è¯è¿‡æ»¤å™¨
//noneï¼ˆå…³é—­å…³é”®è¯è¿‡æ»¤å™¨ï¼‰ / whitelistï¼ˆä»…è®°å½•åŒ…å«å…³é”®å­—çš„è¯·æ±‚ï¼‰ / blacklistï¼ˆä»…è®°å½•ä¸åŒ…å«å…³é”®å­—çš„è¯·æ±‚ï¼‰ / patternï¼ˆåŒ¹é…é€šé…ç¬¦çš„è¯·æ±‚ï¼‰
keyword-filter-type = blacklist
keyword-filter = icloud, ocsp, logs, analytic, imap, adthor, applovin, appnext, talk, dropbox, github, spys, nexdns

[Proxy]
# å½“è¯·æ±‚ä¸º HTTP è¯·æ±‚æ—¶è¿”å›ä¸€ä¸ªæå°çš„ GIF
REJECT-TINYGIF = reject-tinygif
# é˜»æ­¢è¯·æ±‚
REJECT = reject
# ç›´æ¥è¿æ¥
DIRECT = direct

[Proxy Group]
# ç™½åå•æ¨¡å¼ PROXYï¼Œé»‘åå•æ¨¡å¼ DIRECT
ğ—™ğ—¶ğ—»ğ—®ğ—¹ = select, DIRECT, ğ—”ğ—¨ğ—§ğ—¢, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª
# å…·ä½“å“ªä¸ªå­ç­–ç•¥å°†è¢«ä½¿ç”¨, æ ¹æ® Wi-FI çš„ SSID å†³å®š
# ğ—›ğ—¼ğ—ºğ—² â›ºï¸ = ssid, default = ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, cellular = ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, "ssid1" = ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, "ssid2" = DIRECT
ğ—”ğ—¨ğ—§ğ—¢ = url-test, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, policy-path=https://sub.store/download/STT, interval=600, tolerance=100, evaluate-before-use=true
ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª = select, DIRECT, policy-path=https://sub.store/download/Media
ğ™‡ğ™Šğ˜¼ğ˜¿-ğ˜½ğ˜¼ğ™‡ğ˜¼ğ™‰ğ˜¾ğ™€ = load-balance, policy-path=https://sub.store/download/HK, interval=-1, tolerance=100, persistent=true, hidden=true
ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—² = select, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, ğ™‡ğ™Šğ˜¼ğ˜¿-ğ˜½ğ˜¼ğ™‡ğ˜¼ğ™‰ğ˜¾ğ™€
ğ—¡ğ—²ğ˜ğ—³ğ—¹ğ—¶ğ˜… = select, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, ğ™‡ğ™Šğ˜¼ğ˜¿-ğ˜½ğ˜¼ğ™‡ğ˜¼ğ™‰ğ˜¾ğ™€
ğ—˜ğ—ºğ—¯ğ˜† = select, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, DIRECT, hidden=true
ğ—§ğ—²ğ—¹ğ—²ğ—´ğ—¿ğ—®ğ—º = select, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª, ğ™‡ğ™Šğ˜¼ğ˜¿-ğ˜½ğ˜¼ğ™‡ğ˜¼ğ™‰ğ˜¾ğ™€
ğ—”ğ—½ğ—½ğ—¹ğ—² = select, DIRECT, ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª
ğ—”ğ—±ğ—¯ğ—¹ğ—¼ğ—°ğ—¸ = select, REJECT, DIRECT, REJECT-TINYGIF

[Rule]
# Client For macOS
# > Proxy
PROCESS-NAME,v2ray,DIRECT
PROCESS-NAME,ss-local,DIRECT
PROCESS-NAME,UUBooster,DIRECT
# > Download
PROCESS-NAME,aria2c,DIRECT
PROCESS-NAME,fdm,DIRECT
PROCESS-NAME,Folx,DIRECT
PROCESS-NAME,NetTransport,DIRECT
PROCESS-NAME,Thunder,DIRECT
PROCESS-NAME,Transmission,DIRECT
PROCESS-NAME,uTorrent,DIRECT
PROCESS-NAME,WebTorrent,DIRECT
PROCESS-NAME,WebTorrent Helper,DIRECT

# CUSTOM RULES
# > External Resources Update
AND,((DOMAIN,raw.githubusercontent.com), (USER-AGENT,Surge/*)),ğ—™ğ—¶ğ—»ğ—®ğ—¹,notification-text="â™»ï¸External Resources Update",notification-interval=3600

# RULE-SET
# > Unbreak
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Unbreak.list,DIRECT
# > Reject
RULE-SET,https://raw.githubusercontent.com/blankmagic/surge/main/rule/block/reject.list,ğ—”ğ—±ğ—¯ğ—¹ğ—¼ğ—°ğ—¸
# > Youtubeã€Netflixã€Emby
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/YouTube.list,ğ—¬ğ—¼ğ˜‚ğ—§ğ˜‚ğ—¯ğ—²
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/Netflix.list,ğ—¡ğ—²ğ˜ğ—³ğ—¹ğ—¶ğ˜…
RULE-SET,https://raw.githubusercontent.com/blankmagic/surge/main/rule/media/emby.list,ğ—˜ğ—ºğ—¯ğ˜†
# > GlobalMedia
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Streaming.list,ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª
# > Telegram
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Telegram/Telegram.list,ğ—§ğ—²ğ—¹ğ—²ğ—´ğ—¿ğ—®ğ—º
# > Apple Services
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/Apple.list,ğ—”ğ—½ğ—½ğ—¹ğ—²
# > Global
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Global.list,ğ™‹ğ™ğ™Šğ™“ğ™” ğŸª
# > Domestic
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/China.list,DIRECT

IP-CIDR,0.0.0.0/32,REJECT,no-resolve

# Local Area Network
RULE-SET,LAN,DIRECT

# GeoIP China
GEOIP,CN,DIRECT

FINAL,ğ—™ğ—¶ğ—»ğ—®ğ—¹,dns-failed

[Host]
# Firebase Cloud Messaging
mtalk.google.com = 108.177.125.188
# Google Dl
dl.google.com = server:119.29.29.29
dl.l.google.com = server:119.29.29.29
# CUSTOM DNS

[URL Rewrite]
# Redirect Google Search Service
^(http|https):\/\/(www.)?(g|google)\.cn https://www.google.com 302

# Redirect Google Maps Service
^(http|https):\/\/(ditu|maps).google\.cn https://maps.google.com 302

# AbeamTV - api.abema.io
^(http|https):\/\/api\.abema\.io\/v\d\/ip\/check - reject
# CUSTOM URL

[Header Rewrite] 
^https?:\/\/.*\.baidu\.com header-replace User-Agent "Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Mobile/15E148 Safari/16C50 Quark/604.1 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)"

^https?:\/\/.*\.zhihu\.com header-replace User-Agent "osee2unifiedRelease/4432 osee2unifiedReleaseVersion/7.8.0 Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"

[SSID Setting]
# Temporarily Suspend
"CUSTOM SSID" suspend=true

[MITM]
skip-server-cert-verify = true
hostname = www.google.cn, api.abema.io, *.baidu.com, *.zhihu.com, api.weibo.cn, -CUSTOMMitM

[Script]

//å®˜æ–¹æ‰‹å†Œ - https://manual.nssurge.com/
//ç†è§£åŸç† - https://manual.nssurge.com/book/understanding-surge/cn/
//å¸®åŠ©ä¸­å¿ƒ - https://nssurge.zendesk.com/
//æŠ€æœ¯ç¤¾åŒº - https://community.nssurge.com
